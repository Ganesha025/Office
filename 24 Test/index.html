<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<link rel="stylesheet" href="styles.css">
<style>
body{background:rgb(188, 186, 186);font-family:Arial;display:flex;flex-direction: column; justify-content:center;padding-top: 50px;padding-bottom: 30px;}
form{width:850px;background:#fff;padding:25px;border-radius:15px}
section{border:1px solid #444;padding:20px;margin:20px 0;border-radius:10px}
h2{margin-bottom:10px;text-decoration:underline}
.row{display:flex;gap:20px}
.g{flex:1;display:flex;flex-direction:column;margin-bottom:15px}
input,.picker,textarea{padding:8px;border:1px solid #777;border-radius:6px}
.pList{display:none;position:absolute;background:#fff;border:1px solid #ccc;width:100%;z-index:5;border-radius:5px}
.pList div{padding:7px;cursor:pointer}
.pList div:hover{background:#def}
.err{color:red;font-size:13px}
button{padding:10px;font-size:18px;border:none;border-radius:8px;background:#006aff;color:#fff}
button:disabled{background:#777;cursor: not-allowed;}
.pWrap{position:relative}
body form h1{
margin-bottom: 20px;
border-bottom: 8px solid black;
padding-bottom: 10px;border-radius: 10px;
}header {
    background-color: black;
    color: white;width: 100%;padding: 15px  ;border-radius: 20px;margin-bottom: 50px;
    position: sticky;
    top: 0;z-index: 1000;
}
form{
    box-shadow: rgba(0, 0, 0, 0.2) 0px 20px 30px;
}
</style>
</head>

<body>
    <!-- <header>
        <h1>CRM</h1>
    </header> -->
<form id="f">
<h1>CRM</h1>

<section>
<h2>Lead Info</h2>

<div class="row">
<div class="g">
<label>Lead Name *</label>
<input id="leadName" class="val-new-name" placeholder="Enter Name"><div class="err"></div>
</div>

<div class="g">
<label>Company Name *</label>
<input id="company" class="val-com-name" placeholder="Enter Company Name"><div class="err"></div>
</div>
</div>

<div class="row">
<div class="g">
<label>Email *</label>
<input id="email" class="val-email" placeholder="Enter Email ID"><div class="err"></div>
</div>

<div class="g">
<label>Alt Email</label>
<input id="altEmail" class="val-email" placeholder="Enter Alternative Email ID"><div class="err"></div>
</div>
</div>

<div class="row">
<div class="g">
<label>Phone *</label>
<input id="phone" class="val-mobile" placeholder="Enter Mobile Number"><div class="err"></div>
</div>

<div class="g">
<label>Alt Phone</label>
<input id="altPhone" class="val-mobile" placeholder="Enter Alternative Mobile"><div class="err"></div>
</div>
</div>

<div class="g pWrap">
<label>Lead Source *</label>
<div class="picker" id="leadSource"></div>
 <div class="pList" id="leadSourceList"></div>

<div class="err"></div>
</div>

</section>


<section>
<h2>Address</h2>

<div class="row">
<div class="g pWrap">
<label>Country *</label>
<div class="picker" id="country"></div>
<div class="pList" id="countryList"></div>
<div class="err"></div>
</div>

<div class="g pWrap">
<label>State *</label>
<div class="picker" id="state"></div>
<div class="pList" id="stateList"></div>
<div class="err"></div>
</div>
</div>

<div class="row">
<div class="g">
<label>City *</label>
<input id="city" class="val-location" placeholder="Enter City Name"><div class="err"></div>
</div>
<div class="g">
<label>Pincode *</label>
<input id="pin" class="val-pincode" placeholder="Enter Pincode"><div class="err"></div>
</div>
</div>

<div class="g">
<label>Full Address *</label>
<textarea id="addr" class="val-address" placeholder="Enter Your Full Address"></textarea><div class="err"></div>
</div>

</section>


<section>
<h2>Qualification</h2>

<div class="row">
<div class="g pWrap">
<label>Stage *</label>
<div class="picker" id="stage"></div>
<div class="pList" id="stageList"></div>
<div class="err"></div>
</div>

<div class="g">
<label>Lead Score *</label>
<input id="score" class="val-mark" placeholder="Enter Lead Score"><div class="err"></div>
</div>
</div>

<div class="row">
<div class="g pWrap">
<label>Industry *</label>
<div class="picker" id="industry"></div>
<div class="pList" id="industryList"></div>

<div class="err"></div>
</div>

<div class="g">
<label id="ExpectedLabel">Expected Revenue</label>
<input id="revenue" class="val-salary" placeholder="Expected Revenue"><div class="err"></div>
</div>
</div>

<div class="row">
<div class="g">
<label>Min Budget *</label>
<input id="b1" placeholder="Minimum Budget"><div class="err"></div>
</div>
<div class="g">
<label>Max Budget *</label>
<input id="b2" class="val-salary" placeholder="Maximum Budget"><div class="err"></div>
</div>
</div>

</section>

<button id="btn" disabled>Submit</button>
</form>

<script>
  $('#leadName').focus();  

let src=["Website","Facebook","Referral","Existing Customer","Walk-in","Partner","WhatsApp"]
let countries=["India","USA","Dubai"]
let states = [
  "Andhra Pradesh", "Arunachal Pradesh", "Assam", "Bihar", "Chhattisgarh",
  "Goa", "Gujarat", "Haryana", "Himachal Pradesh", "Jharkhand",
  "Karnataka", "Kerala", "Madhya Pradesh", "Maharashtra", "Manipur",
  "Meghalaya", "Mizoram", "Nagaland", "Odisha", "Punjab",
  "Rajasthan", "Sikkim", "Tamil Nadu", "Telangana", "Tripura",
  "Uttar Pradesh", "Uttarakhand", "West Bengal"
];
let stages=["New","Contacted","Interested","Qualified","Proposal Sent","Negotiation","Converted","Lost"]
let inds=["IT","Retail","Manufacturing","Logistics","Education","Finance"]

function loadPicker(id,list){
    let box=$("#"+id+"List")
    list.forEach(v=>box.append("<div>"+v+"</div>"))
    $("#"+id).on("click",()=>box.toggle())
box.on("click","div",function(){
    $("#"+id).text($(this).text()).removeClass("placeholder");
    box.hide();
    validate();
});
}

loadPicker("leadSource",src)
loadPicker("country",countries)
loadPicker("state",states)
loadPicker("stage",stages)
loadPicker("industry",inds)

function e(id,msg){ $("#"+id).nextAll(".err").first().text(msg); }

function validate(){
    $(".err").text("")
    let ok=true

    if(!/^[A-Za-z ]{3,}$/.test(leadName.value)) ok=e("leadName","Invalid")
    if(!/^[A-Za-z0-9 ]{2,}$/.test(company.value)) ok=e("company","Invalid")

    let mail=/^[^\s@]+@[^\s@]+\.[^\s@]+$/
    if(!mail.test(email.value)) ok=e("email","Invalid")
    if(altEmail.value && !mail.test(altEmail.value)) ok=e("altEmail","Invalid")
    if(email.value===altEmail.value && altEmail.value) ok=e("altEmail","Different required")

    if(!/^\d{10}$/.test(phone.value)) ok=e("phone","10 digits")
    if(altPhone.value && !/^\d{10}$/.test(altPhone.value)) ok=e("altPhone","10 digits")
    if(phone.value===altPhone.value && altPhone.value) ok=e("altPhone","Different required")

    if(!leadSource.innerText) ok=e("leadSource","Required")
    if(!country.innerText) ok=e("country","Required")
    if(!state.innerText) ok=e("state","Required")

    if(!/^[A-Za-z]+$/.test(city.value)) ok=e("city","Invalid")
    if(!/^\d{6}$/.test(pin.value)) ok=e("pin","6 digits")
    if(addr.value.length<10) ok=e("addr","Min 10 chars")

    if(!stage.innerText) ok=e("stage","Required")
    if(!(score.value>=1 && score.value<=100)) ok=e("score","1-100")
    if(!industry.innerText) ok=e("industry","Required")

if (["Qualified", "Proposal Sent", "Negotiation"].includes(stage.textContent)) {
    if (!(Number(revenue.value) > 0)) {
        e("revenue", "Required");
        document.getElementById('ExpectedLabel').textContent = 'Expected Revenue *';
        ok = false;
    } else {
        document.getElementById('ExpectedLabel').textContent = 'Expected Revenue';
    }
} else {
    document.getElementById('ExpectedLabel').textContent = 'Expected Revenue';
}

    if(!(b1.value>0)) ok=e("b1","Required")
    if(!(b2.value>0)) ok=e("b2","Required")
    if(Number(b2.value)<=Number(b1.value)) ok=e("b2","Greater")

    $("#btn").prop("disabled",!ok)
    return ok
}

$("input,textarea").on("input",validate)

$("#f").on("submit", function(e) {
    e.preventDefault();

    if (validate()) {
        toast("Submitted");
         this.reset();
        $("#btn").prop("disabled", true); 
        $(".picker").text("").addClass("placeholder"); 
        $(".err").text(""); 
        $('input').css('border-color','black');
        $('textarea').css('border-color','black');

        setTimeout(() => showCustomModal('Submitted Successfully'), 10);
       
       
    }
});

</script>
<script src="valid.js"></script>
</body>
</html>
